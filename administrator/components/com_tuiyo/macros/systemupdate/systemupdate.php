<?php
/**
 * ******************************************************************
 * Tuiyo application                     *
 * ******************************************************************
 * @copyright : 2008 tuiyo Platform                                 *
 * @license   : http://platform.tuiyo.com/license   BSD License     * 
 * @version   : Release: $Id$                                       * 
 * @link      : http://platform.tuiyo.com/                          * 
 * @author 	  : livingstone[at]drstonyhills[dot]com                 * 
 * @access 	  : Public                                              *
 * @since     : 1.0.0 alpha                                         *   
 * @package   : tuiyo    yyeSyV0kysKV2oqpLUES5                                           *
 * ******************************************************************
 */
 
/**
 * no direct access
 */
defined('TUIYO_EXECUTE') || die('Restricted access');


class TuiyoMacroSystemUpdate{
	
	public function __construct(){
		TuiyoEventLoader::preparePlugins( "macros" );
	}
	
	public function run(){
		
		//flush();
		global $mainframe;
		
		//Use Flush to out put
		$params = array(
			'template' 	=> $mainframe->getTemplate(),
			'file'		=> 'index.php',
			'directory'	=> JPATH_THEMES
		);

		$document 	=& JFactory::getDocument();
		$data 		= $document->render($mainframe->getCfg('caching'), $params );
		
		echo _("Welcome to the system update macro...")."<br />";
		 
		ob_flush();
		flush();
		 		
		
		echo _("Preparing to upgrade....")."<br />";
		
		
		$url 		= "http://www.tuiyo.co.uk/version.ini";
		 
		
		//$vParams	= TuiyoAPI::getURL( $url );
		ob_flush();
		flush();

	}
	
	/**
	 * TuiyoMacroSystemUpdate::getInstance()
	 * Creates an instance of the Plugin
	 * @param mixed $ifNotExist
	 * @return
	 */
	public function getInstance($ifNotExist = NULL )
	{
 		/** Creates new instance if none already exists ***/
        static $instance;

        if (is_object($instance) && !$ifNotExist) {
            return $instance;
        } else {
            $instance = new TuiyoMacroSystemUpdate();
        }
        return $instance;
	}
	
}